<!--statistic setting form-->
<div class="row-fluid">
  <div class="span12">
    <%= form_tag('/show_statistic_by_date', :id =>"statisticDateFormId", :remote => true, :class => "form-inline well statisticForm") do -%>
        <legend><%=t('form.title.statistic.date')%></legend>

        <%= label_tag "date_from_id", t('field.common.date_from'), :class => "control-label marginleft10px"%>
        <%= text_field_tag "date_from", Date.today-1.month, :id=>"date_from_id", :readonly => true, :class => "uneditable-input span2"%>

        <%= label_tag "date_to_id", t('field.common.date_to'), :class => "control-label marginleft10px"%>
        <%= text_field_tag "date_to", Date.today, :id=>"date_to_id", :readonly => true, :class => "uneditable-input span2"%>

        <%= label_tag "transaction_type_id", t('field.transaction.type'), :class => "control-label marginleft10px hidden-phone hidden-tablet"%>
        <%= select_tag "transaction_type", getTransactionTypesOptionList.html_safe, :id => "transaction_type_id", :class => "span2 hidden-phone hidden-tablet" %>

        <%= label_tag "category_id", t('field.transaction.category'), :class => "control-label marginleft10px hidden-phone hidden-tablet"%>
        <%= select_tag "category",  options_from_collection_for_select(@categories, "id", "name"),
                       :include_blank => true, :id => "category_id", :class => "span2 hidden-phone hidden-tablet"%>

    <% end -%>
  </div>
</div>

<!--chart container-->
<div class="row-fluid">
  <div class="span12">
    <div id="chartContainer"></div>
  </div>
</div>

<script type="text/javascript">
    var TRANSACTION_FROM_ACCOUNT_TO_CATEGORY = '<%=Transaction::TRANSACTION_FROM_ACCOUNT_TO_CATEGORY.to_s(10)%>';
    var TRANSACTION_FROM_CASH_TO_CATEGORY = '<%=Transaction::TRANSACTION_FROM_CASH_TO_CATEGORY.to_s(10)%>';

    jQuery(document).ready(function(){
        jQuery('#transaction_type_id').change(function(){
            var transaction_type = jQuery('#transaction_type_id').val();
            if(transaction_type == TRANSACTION_FROM_ACCOUNT_TO_CATEGORY
                    || transaction_type == TRANSACTION_FROM_CASH_TO_CATEGORY){
                jQuery('#category_id').removeAttr("disabled");
            }else{
                jQuery('#category_id').attr("disabled",true);
            }
            jQuery('#statisticDateFormId').submit();
        });
        jQuery('#category_id').change(function(){
            jQuery('#statisticDateFormId').submit();
        });
        initStatisticByDateChartOptions('<%=t('form.title.statistic.date')%>','<%=t('field.common.date')%>','<%=t('field.transaction.summa')%>');
        statisticInit();
    });
</script>